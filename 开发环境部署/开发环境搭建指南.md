# 🛠️ ToDoListArea 开发环境搭建指南

## 📋 目录
- [环境要求](#环境要求)
- [快速开始](#快速开始)
- [详细配置](#详细配置)
- [开发工具](#开发工具)
- [常见问题](#常见问题)
- [开发流程](#开发流程)

## 🎯 环境要求

### 必需软件
- **Docker Desktop** >= 4.0.0
- **Docker Compose** >= 2.0.0
- **Git** >= 2.30.0
- **Visual Studio Code** (推荐)

### 推荐软件
- **Node.js** >= 18.0.0 (用于本地前端开发)
- **.NET 8 SDK** (用于本地后端开发)
- **SQL Server Management Studio** (数据库管理)

### 系统要求
- **Windows 10/11** 或 **macOS** 或 **Linux**
- **内存**: 至少 8GB RAM
- **存储**: 至少 10GB 可用空间
- **网络**: 稳定的互联网连接

## 🚀 快速开始

### 1. 克隆项目
```bash
git clone https://github.com/yourusername/ToDoListArea.git
cd ToDoListArea
```

### 2. 进入开发环境部署目录
```bash
cd 开发环境部署
```

### 3. 运行部署脚本

**Windows:**
```cmd
deploy-dev.bat
```

**Linux/macOS:**
```bash
chmod +x deploy-dev.sh
./deploy-dev.sh
```

### 4. 访问应用
- **前端开发服务器**: http://localhost:5175
- **后端API**: http://localhost:5006
- **数据库管理**: http://localhost:8080

## 🔧 详细配置

### 环境变量配置

开发环境使用 `.env.dev` 文件进行配置：

```env
# 数据库配置
DB_SA_PASSWORD=TodoList@2024!Dev

# JWT配置
JWT_SECRET_KEY=dev-jwt-secret-key-for-development-only-not-secure-12345678
JWT_ISSUER=ToDoListArea-Dev
JWT_AUDIENCE=ToDoListArea-Dev-Users
JWT_EXPIRATION=120

# 环境配置
ASPNETCORE_ENVIRONMENT=Development
NODE_ENV=development
```

### 服务端口配置

| 服务 | 端口 | 描述 |
|------|------|------|
| 前端开发服务器 | 5175 | Vite开发服务器，支持热重载 |
| 后端API | 5006 | ASP.NET Core API服务 |
| 数据库 | 1433 | SQL Server数据库 |
| Redis | 6379 | Redis缓存服务 |
| Adminer | 8080 | 数据库管理工具 |

### Docker服务配置

开发环境包含以下Docker服务：

1. **database**: SQL Server 2022 Express
2. **backend**: ASP.NET Core 8.0 API
3. **frontend**: React 18 + Vite开发服务器
4. **redis**: Redis 7缓存服务
5. **adminer**: 数据库管理工具

## 🛠️ 开发工具

### Visual Studio Code 推荐插件

```json
{
  "recommendations": [
    "ms-dotnettools.csharp",
    "ms-vscode.vscode-typescript-next",
    "bradlc.vscode-tailwindcss",
    "esbenp.prettier-vscode",
    "ms-vscode.vscode-json",
    "ms-vscode-remote.remote-containers",
    "ms-azuretools.vscode-docker"
  ]
}
```

### 开发环境配置文件

**前端开发配置** (`.env.frontend.development`):
```env
VITE_API_BASE_URL=http://localhost:5006/api
VITE_APP_TITLE=智能提醒事项管理系统 (开发版)
VITE_DEBUG_MODE=true
```

**后端开发配置** (`appsettings.Development.json`):
```json
{
  "Logging": {
    "LogLevel": {
      "Default": "Information",
      "Microsoft.AspNetCore": "Warning"
    }
  },
  "AllowedHosts": "*",
  "DetailedErrors": true,
  "EnableSensitiveDataLogging": true
}
```

## 🔍 常见问题

### Q1: Docker容器启动失败
**解决方案:**
1. 检查Docker Desktop是否正在运行
2. 确保端口没有被占用
3. 清理Docker缓存: `docker system prune -a`

### Q2: 前端热重载不工作
**解决方案:**
1. 确保源代码目录正确挂载
2. 检查文件权限
3. 重启前端容器: `docker-compose -f docker-compose.dev.yml restart frontend`

### Q3: 数据库连接失败
**解决方案:**
1. 等待数据库容器完全启动（约30秒）
2. 检查数据库密码配置
3. 使用健康检查: `docker-compose -f docker-compose.dev.yml ps`

### Q4: API请求跨域错误
**解决方案:**
1. 检查CORS配置
2. 确保前端API_BASE_URL配置正确
3. 重启后端服务

## 🔄 开发流程

### 日常开发流程

1. **启动开发环境**
   ```bash
   cd 开发环境部署
   ./deploy-dev.sh  # 或 deploy-dev.bat
   ```

2. **前端开发**
   - 代码位置: `WebCode/todo-frontend/src/`
   - 修改代码后自动热重载
   - 访问: http://localhost:5175

3. **后端开发**
   - 代码位置: `ApiCode/ToDoListArea/ToDoListArea/`
   - 修改代码后需要重启容器
   - API文档: http://localhost:5006/swagger

4. **数据库管理**
   - 使用Adminer: http://localhost:8080
   - 连接信息: 服务器=database, 用户名=sa, 密码=TodoList@2024!Dev

### 代码提交流程

1. **提交前检查**
   ```bash
   # 运行测试
   npm test  # 前端测试
   dotnet test  # 后端测试
   
   # 代码格式化
   npm run format  # 前端格式化
   dotnet format  # 后端格式化
   ```

2. **提交代码**
   ```bash
   git add .
   git commit -m "feat: 添加新功能"
   git push origin feature/your-feature
   ```

### 调试技巧

1. **查看日志**
   ```bash
   # 查看所有服务日志
   docker-compose -f docker-compose.dev.yml logs -f
   
   # 查看特定服务日志
   docker-compose -f docker-compose.dev.yml logs -f backend
   ```

2. **进入容器调试**
   ```bash
   # 进入后端容器
   docker exec -it todolist-backend-dev bash
   
   # 进入前端容器
   docker exec -it todolist-frontend-dev sh
   ```

3. **重启服务**
   ```bash
   # 重启所有服务
   docker-compose -f docker-compose.dev.yml restart
   
   # 重启特定服务
   docker-compose -f docker-compose.dev.yml restart backend
   ```

## 📞 技术支持

如果遇到问题，请：
1. 查看本文档的常见问题部分
2. 检查项目的GitHub Issues
3. 联系开发团队

## 📚 相关文档

- [开发环境故障排除](./开发环境故障排除.md)
- [本地开发部署说明](./本地开发部署说明.md)
- [API开发指南](../实施方案/项目实施/API文档.md)
- [数据库设计文档](../实施方案/项目实施/数据库表_实际结构.md)

---

**最后更新**: 2025-08-04
**文档版本**: v1.0
